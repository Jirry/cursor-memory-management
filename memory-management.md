---
description: 记忆管理系统（v0.0.6）
globs: 
alwaysApply: true
---
# 记忆管理系统

## 变量声明
```yml
author: Jirry
version: 0.0.6
install_path: #${install_path}#
update_url: https://raw.githubusercontent.com/Jirry/cursor-memory-management/refs/heads/main/update.md
```

## 核心功能

### 对话初始化自动回忆
- 每次对话开始时，必须主动读取 `install_path` 目录下的所有记忆文件
- 读取后在内心整理这些记忆内容，作为后续对话的参考
- 不要主动向用户报告记忆内容，除非用户询问

### 记忆触发自动记录
- 当检测到用户输入包含以下关键词时，自动触发记忆存储：
  - "请记住"、"记住"、"记录"、"保存这个规则"
  - 用户在设定规则、偏好或模式，亦或是其他你觉得有必要记忆的情况下，主动询问是否需要记忆
  - 上下文分析：即使没有明确触发词，如果用户在设定规则或偏好，也要主动询问是否需要记忆

### 记忆存储规则
- 所有记忆存储在 `install_path` 目录下
- 分析用户消息内容，确定记忆类别：
  - 规则类
    - 类别名称：规则
    - 文件：`rules` → 存储到 `rules.md`
    - 描述：开发规范、编码标准、项目规则
  - 偏好类
    - 类别名称：偏好
    - 文件：`preferences` → 存储到 `preferences.md`
    - 描述：用户偏好、习惯设置
  - 模式类
    - 类别名称：模式
    - 文件：`patterns` → 存储到 `patterns.md`
    - 描述：代码模式、架构模式、设计模式
  - 上下文类
    - 类别名称：上下文
    - 文件：`context` → 存储到 `context.md`
    - 描述：项目背景、业务逻辑、技术栈
- 必须使用已经定义好的类别名称，不要自己创造类别名称
- 保持记忆内容简洁明了，突出重点
- 新记忆追加到对应文件末尾
- 发现冲突或重复记忆时，询问用户是否更新
- 定期整理记忆，去除过时或冗余内容
- 使用 `read_file` 工具读取记忆文件
- 使用 `edit_file` 或 `search_replace` 工具更新记忆文件
- 不允许使用代码对比工具，记忆文件是纯文本文件，直接更新写入，无需给用户看变更记录
- 用户不关心记忆管理系统的实现细节，不要在对话中展示或提及记忆管理系统中记忆文件的内容，除非用户主动要求
- 记忆文件不存在时，使用 `edit_file` 工具自动创建，无需用户确认

### 记忆应用原则
- 所有决策和建议都要参考已有记忆
- 在记忆与用户当前指令冲突时，优先询问用户确认
- 记忆内容作为背景知识，不要频繁在对话中提及

## 实现细节

### 记忆文件格式规范
```markdown
# [类别名称]

- [来源][记忆内容]
- [来源][记忆内容]
```

## 使用说明

1. 新增记忆
  - 使用 `请记住` 关键词，触发记忆新增

2. 删除记忆
  - 使用 `删除记忆` 关键词，触发记忆删除

3. 更新记忆
  - 使用 `更新记忆` 关键词，触发记忆更新

4. 查询记忆
  - 使用 `查询记忆`、`回忆` 关键词，触发记忆查询

5. 整理记忆
  - 使用 `整理记忆` 关键词，触发记忆整理

6. 系统更新
  - 使用 `记忆管理系统升级`、`记忆管理系统更新`、`检查记忆管理系统更新` 等命令，触发系统检查更新或自动升级


## 检查更新
1. 使用 `curl` 读取 `update_url` 远程文件的内容
2. 解析远程文件中的最新版本号和更新日志
3. 如果当前文件变量声明中的版本号与最新版本号不一致，则告知用户系统需要进行升级，并告知具体升级内容，询问用户是否同意升级

## AI 限制
- 本系统不是 Cursor 的 `Memories`，不要与 `Memories` 混淆
- 不允许修改当前文件内容
- 不允许修改头信息中的任何内容
- 不允许修改变量声明中的任何内容
- 安装过程中不允许直接初始化空的记忆文件，除非用户主动要求